<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://example.local/PRD_Client_Airtable_Sync/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>PRD: Client Management with Airtable Sync - EISLAW Docs</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">EISLAW Docs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../INDEX/" class="nav-link">Index</a>
                            </li>
                            <li class="navitem">
                                <a href="../WORKING_MEMORY/" class="nav-link">Working Memory</a>
                            </li>
                            <li class="navitem">
                                <a href="../Testing_Episodic_Log/" class="nav-link">Episodic Log</a>
                            </li>
                            <li class="navitem">
                                <a href="../TEAM_INBOX/" class="nav-link">Team Inbox</a>
                            </li>
                            <li class="navitem">
                                <a href="../DEV_WORKFLOW_DIAGRAM/" class="nav-link">Development Workflow Diagram</a>
                            </li>
                            <li class="navitem">
                                <a href="../WORKFLOW_UPDATE_ANALYSIS/" class="nav-link">Workflow Update Analysis</a>
                            </li>
                            <li class="navitem">
                                <a href="../RESEARCH_SKILLS_ARCHITECTURE/" class="nav-link">Skills Architecture Research</a>
                            </li>
                            <li class="navitem">
                                <a href="../RESEARCH_VM_STORAGE_MIGRATION/" class="nav-link">VM Storage Migration Research</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#prd-client-management-with-airtable-sync" class="nav-link">PRD: Client Management with Airtable Sync</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#1-overview" class="nav-link">1. Overview</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#2-architecture" class="nav-link">2. Architecture</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#3-airtable-configuration" class="nav-link">3. Airtable Configuration</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#4-api-endpoints" class="nav-link">4. API Endpoints</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#5-local-registry-structure" class="nav-link">5. Local Registry Structure</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#6-frontend-implementation-requirements" class="nav-link">6. Frontend Implementation Requirements</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#7-error-handling" class="nav-link">7. Error Handling</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#8-testing" class="nav-link">8. Testing</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#9-deployment-notes" class="nav-link">9. Deployment Notes</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#10-future-enhancements" class="nav-link">10. Future Enhancements</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#11-appendix-airtable-api-reference" class="nav-link">11. Appendix: Airtable API Reference</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="prd-client-management-with-airtable-sync">PRD: Client Management with Airtable Sync</h1>
<p><strong>Version:</strong> 1.0
<strong>Date:</strong> 2025-12-01
<strong>Status:</strong> Implemented (Backend) / Pending (Frontend UI)</p>
<hr />
<h2 id="1-overview">1. Overview</h2>
<h3 id="11-goal">1.1 Goal</h3>
<p>Enable users to create, update, and manage clients directly from the EISLAW Dashboard web application, with automatic bidirectional synchronization to Airtable.</p>
<h3 id="12-background">1.2 Background</h3>
<ul>
<li>Airtable serves as the contact/CRM database</li>
<li>The Dashboard app maintains a local registry (<code>clients.json</code>) for active clients</li>
<li>Only clients actively imported into the system should appear in the Dashboard</li>
<li>Changes made in the Dashboard should reflect in Airtable</li>
</ul>
<h3 id="13-user-story">1.3 User Story</h3>
<blockquote>
<p>As a law firm staff member, I want to create and manage client records in the Dashboard so that client information is automatically synced to Airtable without manual data entry in multiple systems.</p>
</blockquote>
<hr />
<h2 id="2-architecture">2. Architecture</h2>
<h3 id="21-data-flow">2.1 Data Flow</h3>
<pre><code>┌─────────────────┐         ┌──────────────────┐         ┌─────────────┐
│   Dashboard UI  │ ──API──▶│  Backend (FastAPI)│ ──HTTP──▶│  Airtable   │
└─────────────────┘         └──────────────────┘         └─────────────┘
                                    │
                                    ▼
                            ┌──────────────────┐
                            │  clients.json    │
                            │  (local registry)│
                            └──────────────────┘
</code></pre>
<h3 id="22-key-files">2.2 Key Files</h3>
<table>
<thead>
<tr>
<th>File</th>
<th>Location</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>backend/main.py</code></td>
<td><code>/app/backend/main.py</code></td>
<td>API endpoints</td>
</tr>
<tr>
<td><code>backend/airtable_sync.py</code></td>
<td><code>/app/backend/airtable_sync.py</code></td>
<td>Airtable API integration</td>
</tr>
<tr>
<td><code>clients.json</code></td>
<td><code>/home/azureuser/.eislaw/store/clients.json</code></td>
<td>Local client registry</td>
</tr>
<tr>
<td><code>secrets.local.json</code></td>
<td><code>/app/secrets.local.json</code></td>
<td>API credentials</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="3-airtable-configuration">3. Airtable Configuration</h2>
<h3 id="31-credentials-from-secretslocaljson">3.1 Credentials (from <code>secrets.local.json</code>)</h3>
<pre><code class="language-json">{
  &quot;airtable&quot;: {
    &quot;token&quot;: &quot;pat0g8TPbwjuned7w.xxxxx&quot;,
    &quot;base_id&quot;: &quot;appv3nlRQTtsk97Y5&quot;,
    &quot;clients_table&quot;: &quot;tbloKUYGtEEdM76Nm&quot;,
    &quot;contacts_table&quot;: &quot;tblWVZn9VjoGjdWrX&quot;,
    &quot;view_clients&quot;: &quot;viw34b0ytkGoQd1n3&quot;
  }
}
</code></pre>
<h3 id="32-clients-table-schema">3.2 Clients Table Schema (לקוחות)</h3>
<table>
<thead>
<tr>
<th>Airtable Field</th>
<th>Field Type</th>
<th>App Field</th>
<th>Required</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>לקוחות</td>
<td>singleLineText</td>
<td><code>display_name</code></td>
<td>Yes</td>
<td>Client name</td>
</tr>
<tr>
<td>מספר טלפון</td>
<td>phoneNumber</td>
<td><code>phone</code></td>
<td>No</td>
<td>Format: +972-XX-XXX-XXXX</td>
</tr>
<tr>
<td>אימייל</td>
<td>email</td>
<td><code>email[0]</code></td>
<td>No</td>
<td>Primary email</td>
</tr>
<tr>
<td>סוג לקוח</td>
<td>multipleSelects</td>
<td><code>client_type</code></td>
<td>No</td>
<td>Options: בטיפול, ריטיינר, ליטיגציה, etc.</td>
</tr>
<tr>
<td>בטיפול</td>
<td>singleSelect</td>
<td><code>stage</code></td>
<td>No</td>
<td>Current status</td>
</tr>
<tr>
<td>הערות</td>
<td>multilineText</td>
<td><code>notes</code></td>
<td>No</td>
<td>Free text notes</td>
</tr>
<tr>
<td>אנשי קשר נוספים</td>
<td>multipleRecordLinks</td>
<td><code>contacts</code></td>
<td>No</td>
<td>Links to contacts table</td>
</tr>
<tr>
<td>Created</td>
<td>createdTime</td>
<td><code>created_at</code></td>
<td>Auto</td>
<td>Airtable auto-generated</td>
</tr>
</tbody>
</table>
<h3 id="33-contacts-table-schema">3.3 Contacts Table Schema (אנשי קשר נוספים)</h3>
<table>
<thead>
<tr>
<th>Airtable Field</th>
<th>Field Type</th>
<th>App Field</th>
<th>Required</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>שם איש קשר</td>
<td>singleLineText</td>
<td><code>contact.name</code></td>
<td>Yes</td>
<td>Contact name</td>
</tr>
<tr>
<td>מייל</td>
<td>singleLineText</td>
<td><code>contact.email</code></td>
<td>No</td>
<td></td>
</tr>
<tr>
<td>טלפון</td>
<td>phoneNumber</td>
<td><code>contact.phone</code></td>
<td>No</td>
<td></td>
</tr>
<tr>
<td>לקוח</td>
<td>multipleRecordLinks</td>
<td>(auto-linked)</td>
<td>Yes</td>
<td>Link to parent client</td>
</tr>
<tr>
<td>תפקיד איש קשר</td>
<td>singleLineText</td>
<td><code>contact.role_desc</code></td>
<td>No</td>
<td>Job title/role</td>
</tr>
<tr>
<td>כתובת</td>
<td>singleLineText</td>
<td><code>contact.address</code></td>
<td>No</td>
<td></td>
</tr>
<tr>
<td>מספר זיהוי</td>
<td>singleLineText</td>
<td><code>contact.id_number</code></td>
<td>No</td>
<td>ID/passport number</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="4-api-endpoints">4. API Endpoints</h2>
<h3 id="41-create-client">4.1 Create Client</h3>
<p><strong>Endpoint:</strong> <code>POST /api/clients</code></p>
<p><strong>Request:</strong></p>
<pre><code class="language-json">{
  &quot;display_name&quot;: &quot;שם הלקוח&quot;,
  &quot;email&quot;: [&quot;email@example.com&quot;],
  &quot;phone&quot;: &quot;+972-52-1234567&quot;,
  &quot;client_type&quot;: [&quot;בטיפול&quot;],
  &quot;stage&quot;: &quot;&quot;,
  &quot;notes&quot;: &quot;&quot;,
  &quot;contacts&quot;: []
}
</code></pre>
<p><strong>Response (201 Created):</strong></p>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;uuid-local-id&quot;,
  &quot;display_name&quot;: &quot;שם הלקוח&quot;,
  &quot;slug&quot;: &quot;שם-הלקוח&quot;,
  &quot;email&quot;: [&quot;email@example.com&quot;],
  &quot;phone&quot;: &quot;+972-52-1234567&quot;,
  &quot;client_type&quot;: [&quot;בטיפול&quot;],
  &quot;stage&quot;: &quot;&quot;,
  &quot;notes&quot;: &quot;&quot;,
  &quot;contacts&quot;: [],
  &quot;folder&quot;: &quot;&quot;,
  &quot;airtable_id&quot;: &quot;recXXXXXXXX&quot;,
  &quot;airtable_url&quot;: &quot;https://airtable.com/appv3nlRQTtsk97Y5/tbloKUYGtEEdM76Nm/recXXXXXXXX&quot;,
  &quot;created_at&quot;: &quot;2025-12-01T09:00:00.000000&quot;
}
</code></pre>
<p><strong>Validation:</strong>
- <code>display_name</code> is required
- Returns 409 if client with same name exists</p>
<h3 id="42-update-client">4.2 Update Client</h3>
<p><strong>Endpoint:</strong> <code>PUT /api/clients/{client_id}</code></p>
<p><strong>Request:</strong></p>
<pre><code class="language-json">{
  &quot;display_name&quot;: &quot;שם חדש&quot;,
  &quot;phone&quot;: &quot;+972-52-9999999&quot;,
  &quot;notes&quot;: &quot;הערות חדשות&quot;
}
</code></pre>
<p><strong>Notes:</strong>
- <code>client_id</code> can be local UUID or Airtable record ID
- Only provided fields are updated
- Automatically syncs changes to Airtable if <code>airtable_id</code> exists</p>
<h3 id="43-get-all-clients">4.3 Get All Clients</h3>
<p><strong>Endpoint:</strong> <code>GET /api/clients</code></p>
<p><strong>Response:</strong></p>
<pre><code class="language-json">[
  {
    &quot;id&quot;: &quot;uuid&quot;,
    &quot;name&quot;: &quot;שם הלקוח&quot;,
    &quot;email&quot;: &quot;primary@email.com&quot;,
    &quot;phone&quot;: &quot;+972-52-1234567&quot;,
    &quot;folder&quot;: &quot;/path/to/folder&quot;,
    &quot;airtable_id&quot;: &quot;recXXX&quot;,
    &quot;contacts&quot;: [...],
    &quot;client_type&quot;: [&quot;בטיפול&quot;],
    &quot;stage&quot;: &quot;&quot;
  }
]
</code></pre>
<h3 id="44-get-single-client">4.4 Get Single Client</h3>
<p><strong>Endpoint:</strong> <code>GET /api/clients/{client_id}</code></p>
<p>Returns full client object including all contacts.</p>
<h3 id="45-import-from-airtable">4.5 Import from Airtable</h3>
<p><strong>Endpoint:</strong> <code>POST /api/clients/import-from-airtable</code></p>
<p><strong>Request:</strong></p>
<pre><code class="language-json">{
  &quot;airtable_id&quot;: &quot;recXXXXXXXX&quot;
}
</code></pre>
<p><strong>Purpose:</strong> Import an existing Airtable contact into the active clients registry.</p>
<p><strong>Response:</strong> Full client object with data fetched from Airtable.</p>
<h3 id="46-add-contact-to-client">4.6 Add Contact to Client</h3>
<p><strong>Endpoint:</strong> <code>POST /api/clients/{client_id}/contacts</code></p>
<p><strong>Request:</strong></p>
<pre><code class="language-json">{
  &quot;name&quot;: &quot;איש קשר&quot;,
  &quot;email&quot;: &quot;contact@example.com&quot;,
  &quot;phone&quot;: &quot;+972-50-1111111&quot;,
  &quot;role_desc&quot;: &quot;מנהל כספים&quot;,
  &quot;address&quot;: &quot;תל אביב&quot;,
  &quot;id_number&quot;: &quot;123456789&quot;
}
</code></pre>
<p><strong>Notes:</strong>
- Creates contact in Airtable's contacts table
- Links contact to parent client via <code>לקוח</code> field
- Returns contact object with <code>airtable_id</code></p>
<hr />
<h2 id="5-local-registry-structure">5. Local Registry Structure</h2>
<h3 id="51-file-location">5.1 File Location</h3>
<pre><code>Host: /home/azureuser/.eislaw/store/clients.json
Container: /home/azureuser/.eislaw/store/clients.json (volume mounted)
</code></pre>
<h3 id="52-full-schema">5.2 Full Schema</h3>
<pre><code class="language-json">{
  &quot;clients&quot;: [
    {
      &quot;id&quot;: &quot;1a21f1ac-a3e8-4d46-bee0-b2d374854e60&quot;,
      &quot;display_name&quot;: &quot;סיון בנימיני&quot;,
      &quot;slug&quot;: &quot;סיון-בנימיני&quot;,
      &quot;email&quot;: [&quot;sivan@thepowerskill.com&quot;, &quot;sisivani@gmail.com&quot;],
      &quot;phone&quot;: &quot;+972549482920&quot;,
      &quot;client_type&quot;: [&quot;בטיפול&quot;],
      &quot;stage&quot;: &quot;טיפול הושלם&quot;,
      &quot;notes&quot;: &quot;לקוח VIP&quot;,
      &quot;contacts&quot;: [
        {
          &quot;id&quot;: &quot;contact-uuid-123&quot;,
          &quot;name&quot;: &quot;יוסי כהן&quot;,
          &quot;email&quot;: &quot;yossi@company.com&quot;,
          &quot;phone&quot;: &quot;+972-50-1234567&quot;,
          &quot;role_desc&quot;: &quot;מנכ״ל&quot;,
          &quot;address&quot;: &quot;רחוב הרצל 1, תל אביב&quot;,
          &quot;id_number&quot;: &quot;123456789&quot;,
          &quot;airtable_id&quot;: &quot;recCONTACT123&quot;
        }
      ],
      &quot;folder&quot;: &quot;C:\\Users\\USER\\...\\לקוחות משרד\\סיון בנימיני&quot;,
      &quot;airtable_id&quot;: &quot;recxQ7jWauNY7fr5c&quot;,
      &quot;airtable_url&quot;: &quot;https://airtable.com/appv3nlRQTtsk97Y5/tbloKUYGtEEdM76Nm/recxQ7jWauNY7fr5c&quot;,
      &quot;created_at&quot;: &quot;2025-10-25T22:43:00&quot;,
      &quot;updated_at&quot;: &quot;2025-12-01T09:00:00&quot;
    }
  ]
}
</code></pre>
<hr />
<h2 id="6-frontend-implementation-requirements">6. Frontend Implementation Requirements</h2>
<h3 id="61-components-needed">6.1 Components Needed</h3>
<table>
<thead>
<tr>
<th>Component</th>
<th>Purpose</th>
<th>Priority</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ClientCreateModal</code></td>
<td>Modal form for creating new client</td>
<td>High</td>
</tr>
<tr>
<td><code>ClientEditForm</code></td>
<td>Form for editing client details</td>
<td>High</td>
</tr>
<tr>
<td><code>ContactAddForm</code></td>
<td>Sub-form for adding contacts</td>
<td>Medium</td>
</tr>
<tr>
<td><code>AirtableImportModal</code></td>
<td>Search and import from Airtable</td>
<td>Medium</td>
</tr>
<tr>
<td><code>ClientTypeSelect</code></td>
<td>Multi-select for client types</td>
<td>High</td>
</tr>
</tbody>
</table>
<h3 id="62-form-specifications">6.2 Form Specifications</h3>
<h4 id="createedit-client-form">Create/Edit Client Form</h4>
<table>
<thead>
<tr>
<th>Field</th>
<th>Input Type</th>
<th>Validation</th>
<th>Label (Hebrew)</th>
</tr>
</thead>
<tbody>
<tr>
<td>display_name</td>
<td>text</td>
<td>required, min 2 chars</td>
<td>שם לקוח</td>
</tr>
<tr>
<td>email</td>
<td>email (repeater)</td>
<td>valid email format</td>
<td>אימייל</td>
</tr>
<tr>
<td>phone</td>
<td>tel</td>
<td>Israeli phone regex</td>
<td>טלפון</td>
</tr>
<tr>
<td>client_type</td>
<td>multi-select</td>
<td>from CLIENT_TYPES</td>
<td>סוג לקוח</td>
</tr>
<tr>
<td>stage</td>
<td>select</td>
<td>from STAGES</td>
<td>סטטוס</td>
</tr>
<tr>
<td>notes</td>
<td>textarea</td>
<td>max 5000 chars</td>
<td>הערות</td>
</tr>
</tbody>
</table>
<h4 id="contact-form">Contact Form</h4>
<table>
<thead>
<tr>
<th>Field</th>
<th>Input Type</th>
<th>Validation</th>
<th>Label (Hebrew)</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>text</td>
<td>required</td>
<td>שם איש קשר</td>
</tr>
<tr>
<td>email</td>
<td>email</td>
<td>valid format</td>
<td>אימייל</td>
</tr>
<tr>
<td>phone</td>
<td>tel</td>
<td>Israeli format</td>
<td>טלפון</td>
</tr>
<tr>
<td>role_desc</td>
<td>text</td>
<td>-</td>
<td>תפקיד</td>
</tr>
<tr>
<td>address</td>
<td>text</td>
<td>-</td>
<td>כתובת</td>
</tr>
<tr>
<td>id_number</td>
<td>text</td>
<td>9 digits</td>
<td>ת.ז.</td>
</tr>
</tbody>
</table>
<h3 id="63-select-options">6.3 Select Options</h3>
<pre><code class="language-typescript">const CLIENT_TYPES = [
  { value: &quot;בטיפול&quot;, label: &quot;בטיפול&quot; },
  { value: &quot;ריטיינר&quot;, label: &quot;ריטיינר&quot; },
  { value: &quot;ליטיגציה&quot;, label: &quot;ליטיגציה&quot; },
  { value: &quot;טיפול הושלם&quot;, label: &quot;טיפול הושלם&quot; },
  { value: &quot;פוטנציאלי&quot;, label: &quot;פוטנציאלי&quot; }
];

const STAGES = [
  { value: &quot;&quot;, label: &quot;לא נבחר&quot; },
  { value: &quot;חדש&quot;, label: &quot;חדש&quot; },
  { value: &quot;בתהליך&quot;, label: &quot;בתהליך&quot; },
  { value: &quot;ממתין&quot;, label: &quot;ממתין&quot; },
  { value: &quot;הושלם&quot;, label: &quot;הושלם&quot; }
];
</code></pre>
<h3 id="64-api-integration-example">6.4 API Integration Example</h3>
<pre><code class="language-typescript">// Create client
const createClient = async (data: ClientInput) =&gt; {
  const response = await fetch('/api/clients', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(data)
  });

  if (response.status === 409) {
    throw new Error('לקוח עם שם זה כבר קיים');
  }

  return response.json();
};

// Update client
const updateClient = async (id: string, data: Partial&lt;ClientInput&gt;) =&gt; {
  const response = await fetch(`/api/clients/${id}`, {
    method: 'PUT',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(data)
  });

  return response.json();
};
</code></pre>
<hr />
<h2 id="7-error-handling">7. Error Handling</h2>
<h3 id="71-http-status-codes">7.1 HTTP Status Codes</h3>
<table>
<thead>
<tr>
<th>Code</th>
<th>Meaning</th>
<th>Frontend Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>Success</td>
<td>Show success toast</td>
</tr>
<tr>
<td>201</td>
<td>Created</td>
<td>Show success + redirect</td>
</tr>
<tr>
<td>400</td>
<td>Bad request (validation)</td>
<td>Show field errors</td>
</tr>
<tr>
<td>404</td>
<td>Client not found</td>
<td>Redirect to list</td>
</tr>
<tr>
<td>409</td>
<td>Duplicate client</td>
<td>Show warning modal</td>
</tr>
<tr>
<td>500</td>
<td>Server error</td>
<td>Show retry option</td>
</tr>
</tbody>
</table>
<h3 id="72-airtable-sync-behavior">7.2 Airtable Sync Behavior</h3>
<ul>
<li><strong>Success:</strong> Client saved locally + synced to Airtable, <code>airtable_id</code> populated</li>
<li><strong>Failure:</strong> Client saved locally only, <code>airtable_id</code> empty, error logged</li>
<li><strong>Retry:</strong> Future enhancement - queue failed syncs for retry</li>
</ul>
<hr />
<h2 id="8-testing">8. Testing</h2>
<h3 id="81-manual-api-tests">8.1 Manual API Tests</h3>
<pre><code class="language-bash"># Base URL
API_URL=&quot;http://20.217.86.4:8799&quot;

# Create client
curl -X POST &quot;$API_URL/api/clients&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d '{&quot;display_name&quot;: &quot;לקוח בדיקה&quot;, &quot;email&quot;: [&quot;test@eislaw.co.il&quot;], &quot;phone&quot;: &quot;052-1234567&quot;}'

# Get all clients
curl &quot;$API_URL/api/clients&quot;

# Get single client
curl &quot;$API_URL/api/clients/{id}&quot;

# Update client
curl -X PUT &quot;$API_URL/api/clients/{id}&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d '{&quot;phone&quot;: &quot;052-9999999&quot;}'

# Add contact
curl -X POST &quot;$API_URL/api/clients/{id}/contacts&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d '{&quot;name&quot;: &quot;איש קשר חדש&quot;, &quot;email&quot;: &quot;contact@test.com&quot;}'

# Import from Airtable
curl -X POST &quot;$API_URL/api/clients/import-from-airtable&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d '{&quot;airtable_id&quot;: &quot;recXXXXXXXX&quot;}'
</code></pre>
<h3 id="82-verification-checklist">8.2 Verification Checklist</h3>
<ul>
<li>[ ] Client appears in <code>/api/clients</code> response</li>
<li>[ ] Client record created in Airtable (check via Airtable UI)</li>
<li>[ ] <code>airtable_id</code> and <code>airtable_url</code> populated in response</li>
<li>[ ] Update reflects in both local registry and Airtable</li>
<li>[ ] Contact created and linked to client in Airtable</li>
</ul>
<hr />
<h2 id="9-deployment-notes">9. Deployment Notes</h2>
<h3 id="91-environment">9.1 Environment</h3>
<ul>
<li><strong>VM:</strong> Azure VM at <code>20.217.86.4</code></li>
<li><strong>API Port:</strong> 8799</li>
<li><strong>Frontend Port:</strong> 8080 (or 5173 for dev)</li>
</ul>
<h3 id="92-docker-volume">9.2 Docker Volume</h3>
<pre><code class="language-yaml"># docker-compose.yml
volumes:
  - /home/azureuser/.eislaw/store:/home/azureuser/.eislaw/store
</code></pre>
<h3 id="93-required-secrets">9.3 Required Secrets</h3>
<p>Ensure <code>secrets.local.json</code> contains:
- <code>airtable.token</code>
- <code>airtable.base_id</code>
- <code>airtable.clients_table</code>
- <code>airtable.contacts_table</code>
- <code>store_base</code> (path to registry directory)</p>
<hr />
<h2 id="10-future-enhancements">10. Future Enhancements</h2>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Description</th>
<th>Priority</th>
</tr>
</thead>
<tbody>
<tr>
<td>SharePoint folder</td>
<td>Auto-create client folder on SharePoint</td>
<td>High</td>
</tr>
<tr>
<td>Bulk import</td>
<td>Import multiple clients from Airtable</td>
<td>Medium</td>
</tr>
<tr>
<td>Sync indicator</td>
<td>Show sync status in UI</td>
<td>Medium</td>
</tr>
<tr>
<td>Delete sync</td>
<td>Sync deletions to Airtable</td>
<td>Low</td>
</tr>
<tr>
<td>Conflict resolution</td>
<td>Handle data conflicts</td>
<td>Low</td>
</tr>
<tr>
<td>Audit log</td>
<td>Track all changes</td>
<td>Low</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="11-appendix-airtable-api-reference">11. Appendix: Airtable API Reference</h2>
<h3 id="base-url">Base URL</h3>
<pre><code>https://api.airtable.com/v0/{base_id}/{table_id}
</code></pre>
<h3 id="authentication">Authentication</h3>
<pre><code>Authorization: Bearer {token}
</code></pre>
<h3 id="create-record">Create Record</h3>
<pre><code class="language-http">POST /v0/{base_id}/{table_id}
Content-Type: application/json

{
  &quot;fields&quot;: {
    &quot;לקוחות&quot;: &quot;שם הלקוח&quot;,
    &quot;מספר טלפון&quot;: &quot;+972-52-1234567&quot;
  }
}
</code></pre>
<h3 id="update-record">Update Record</h3>
<pre><code class="language-http">PATCH /v0/{base_id}/{table_id}/{record_id}
Content-Type: application/json

{
  &quot;fields&quot;: {
    &quot;מספר טלפון&quot;: &quot;+972-52-9999999&quot;
  }
}
</code></pre>
<h3 id="get-record">Get Record</h3>
<pre><code class="language-http">GET /v0/{base_id}/{table_id}/{record_id}
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/jquery-3.6.0.min.js"></script>
        <script src="../js/bootstrap.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
